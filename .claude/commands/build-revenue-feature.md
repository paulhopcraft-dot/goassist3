---
name: build-revenue-feature
aliases: [revenue, build-rev]
version: 1.0.0
auto_generated: true
learned_from: 17 govertical features (2025-12-25)
description: Build revenue domain features following YOUR established patterns
---

<command_role>
Build revenue domain features using patterns learned from YOUR 17 completed features in govertical.

This command was AUTO-GENERATED by analyzing your actual code patterns.
</command_role>

<learned_patterns>
## YOUR Revenue Domain Patterns (from 17 features)

**Compliance Requirements** (from domain.json):
- SOX/GAAP compliance ALWAYS required
- Decimal precision for money (NEVER float)
- Audit trail logging MANDATORY

**Feature Categories You Build**:
1. Intelligence Engines (F003, F007, F012, F015, F016)
2. Data Management (F001, F002, F004, F005)
3. Orchestration Systems (F010, F011, F013)
4. Analytics/Dashboards (F013, F014)
5. Evaluation/Scoring (F003, F006, F017)

**Technical Patterns You Use**:
- Repository pattern (100% of features)
- TypeScript strict mode with 80+ interfaces
- Scoring algorithms with weighted matrices
- State machines for workflows
- Webhook integration patterns
- Comprehensive acceptance criteria

**Your Success Rate**: 17/17 (100% completion)
</learned_patterns>

<workflow>
STEP 1: Understand Feature Type
  → Read feature description
  → Classify: Intelligence / Data / Orchestration / Analytics / Evaluation
  → Apply category-specific patterns

STEP 2: Apply Revenue Domain Requirements
  ✓ Use Decimal for ALL money amounts (SOX/GAAP)
  ✓ Add audit logging for ALL mutations
  ✓ TypeScript interfaces first (like F008 pattern)
  ✓ Repository pattern (like F001-F017)

STEP 3: Implement Using YOUR Patterns

  IF Intelligence Engine:
    → Follow F003/F015/F016 patterns
    → Scoring algorithm with weights
    → Analytics/insights generation
    → Profile/summary builders

  IF Data Management:
    → Follow F001/F002/F004 patterns
    → CRUD operations
    → Status tracking
    → Stats/analytics methods

  IF Orchestration:
    → Follow F010/F011 patterns
    → State machine if workflow
    → Webhook handlers if external
    → Event logging

  IF Analytics/Dashboard:
    → Follow F013/F014 patterns
    → Metrics calculation
    → Dashboard data API
    → Visualization endpoints

  IF Evaluation/Scoring:
    → Follow F003/F017 patterns
    → Weighted scoring matrix
    → Decision logic (GO/HOLD/KILL)
    → Rejection reasons

STEP 4: Acceptance Criteria (YOUR Style)
  → Write detailed criteria (4-5 per feature, like you do)
  → Include verification steps
  → Mark passes: false initially

STEP 5: Implementation
  → Create repository file
  → Implement methods
  → Add TypeScript types
  → Include audit logging

STEP 6: Update features.json
  → Add feature with YOUR format
  → Include acceptance_criteria array
  → Mark complete when verified

STEP 7: Git Commit
  → Use conventional commits (feat:)
  → Detailed message like your style
</workflow>

<sox_gaap_compliance>
## Automatic Compliance (YOUR Domain)

ALWAYS include:
```typescript
// Decimal for money (GAAP requirement)
import { Decimal } from 'decimal.js';

// Example from your patterns:
const amount = new Decimal(transaction.amount);
const total = amount.times(quantity);  // NOT: amount * quantity

// Audit trail (SOX requirement)
await auditLog.record({
  actor: userId,
  action: 'CREATE_TRANSACTION',
  resource: `transaction/${id}`,
  before: {},
  after: { amount: amount.toString(), ...},
  timestamp: new Date().toISOString()
});
```

NEVER use:
- Float for money calculations
- Mutations without audit logging
</sox_gaap_compliance>

<example_usage>
## Example: Build New Intelligence Engine

User: /build-revenue-feature "Customer Lifetime Value Engine"

Generated Code:
1. Creates: src/db/repositories/customer-ltv.ts
2. Implements:
   - Repository pattern (like F015)
   - Scoring algorithm (like F003)
   - Decimal precision for LTV calculations
   - Audit logging on all updates
   - TypeScript interfaces
3. Updates features.json with YOUR format
4. Commits: "feat: add customer lifetime value engine"

Follows YOUR patterns automatically!
</example_usage>

<success_metrics>
## Measured from YOUR 17 Features

- Completion Rate: 100% (17/17)
- Pattern Consistency: High (all use repository pattern)
- Compliance: 100% (SOX/GAAP in all financial features)
- Acceptance Criteria: Average 4.5 per feature
- TypeScript Coverage: 100%

This command replicates YOUR success patterns!
</success_metrics>

<auto_sync>
Will sync to:
- ✓ goassist3 (general domain - can use revenue patterns)
- ✗ gpnet3 (healthcare domain - different compliance)
</auto_sync>
